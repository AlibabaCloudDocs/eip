# 组合购买云资源和EIP实例

您可以组合购买云资源（ECS实例、NAT网关实例或SLB实例）和EIP实例。组合购买成功后，EIP实例会自动绑定到云资源上。

## 组合购ECS实例（已有VPC）

您可以利用资源编排服务ROS（Resource Orchestration Service），批量创建ECS实例和EIP实例，并完成EIP实例绑定到ECS实例，实现快速批量部署带公网的ECS服务器上线。关于如何使用资源编排服务，请参见[什么是资源编排服务](/intl.zh-CN/产品简介/什么是资源编排服务.md)。

在已有VPC场景下组合购买ECS示例前，您需要创建VPC和交换机。具体操作，请参见[搭建IPv4专有网络](/intl.zh-CN/快速入门/搭建IPv4专有网络.md)。

1.  登录[弹性公网IP管理控制台](https://vpc.console.aliyun.com/eip)。

2.  在顶部菜单栏处，选择EIP的地域。

3.  在**弹性公网IP**页面，选择**组合购买** \> **组合购ECS（已有VPC）**。

4.  在**组合购ECS（已有VPC）**对话框，完成以下操作。

    1.  配置以下模板参数信息，然后单击**下一步**。

        配置完成模板参数信息后，您可以单击**创建**，跳过配置资源栈信息和检查并确认配置信息步骤，直接组合创建ECS实例和EIP实例。

        **说明：** 您也可以单击**上一步**，然后单击**选择已有模板**，根据控制台提示，组合创建ECS实例和EIP实例。

        |配置|说明|
        |--|--|
        |**资源栈名称**|资源栈的名称，可以包含数字、大小写字母、短划线（-）、下划线（\_），必须以字母开头，且长度必须小于255个字符。|
        |**VPC**|
        |**专有网络VPC实例ID**|已有VPC的实例ID。|
        |**交换机实例ID**|所选VPC下的交换机实例ID，ECS实例将创建在此交换机下。|
        |**业务安全组ID**|所选VPC下的安全组实例ID。|
        |**EIP**|
        |**弹性公网带宽**|EIP实例的带宽，取值范围：**1**~**200**， 单位：Mbps。|
        |**弹性公网地址的收费类型**|        -   **PayByBandwidth**：按带宽付费。
        -   **PayByTraffic**：按流量付费。 |
        |**ECS**|
        |**数量**|需要创建的ECS实例和EIP实例的数量，1组ECS实例和EIP实例算1个，取值范围：**1**~**140**。|
        |**交换机可用区**|选择ECS实例的交换机可用区，此处的交换机可用区和已选择的交换机实例必须在同一个可用区。|
        |**镜像**|选择ECS实例的镜像。|
        |**实例规格**|选择ECS实例的规格。选择规格前请先确认当前可用区下该规格是否有货。|
        |**系统盘类型**|选择ECS实例的系统盘类型。|
        |**系统盘空间**|填写系统盘的空间大小，取值范围：**40**~**500**， 单位：GB。|
        |**实例的付费方式**|选择ECS实例的付费方式。        -   **PostPaid**：按量付费。
        -   **PrePaid**：包年包月。 |
        |**实例密码**|设置ECS实例的登录密码，如果ECS实例选择用实例密码登录，则**密钥对名称**可不填。如果ECS实例选择用密钥对登录，则**实例密码**可不填。|
        |**密钥对名称**|输入已有密钥对的名称。如使用**实例密码**登录，**密钥对名称**不需要填写。|

    2.  （可选）配置资源栈信息，然后单击**下一步**。

        |配置|说明|
        |--|--|
        |**资源栈策略**|选择资源栈策略。        -   **无资源栈策略**：不设置资源栈策略。
        -   **输入资源栈策略**：上传文件或在文本框手动输入资源栈策略。
关于资源栈策略详情，请参见[资源栈策略](/intl.zh-CN/资源栈/资源栈策略.md)。|
        |**失败时回滚**|        -   **已启用**：创建资源栈失败时，启用回滚策略。
        -   **已禁用**：创建资源栈失败时，禁用回滚策略。 |
        |**超时设置**|如果所有资源的创建或更新没有在这个时间内完成，系统将自动回滚到创建或更新之前的状态。取值范围：**10**~**1440**，单位：分钟。|
        |**删除保护**|防止资源栈被意外删除。        -   **已启用**：启用删除保护。
        -   **已禁用**：禁用删除保护。 |
        |**RAM角色**|您可以创建可信实体为资源编排服务的RAM角色，然后根据ROS模板中资源所需最小权限为RAM角色授权。        -   如果指定RAM角色，ROS将根据RAM角色的权限创建资源栈。关于如何创建RAM角色和为RAM角色授权，请参见[创建可信实体为阿里云服务的RAM角色](/intl.zh-CN/角色管理/创建RAM角色/创建可信实体为阿里云服务的RAM角色.md)和[为RAM角色授权](/intl.zh-CN/角色管理/为RAM角色授权.md)。
        -   如果不指定RAM角色，ROS将使用当前账号相关权限创建资源栈。 |
        |**标签**|添加标签。标签由一对键值对组成，方便您对资源栈进行分类。|

    3.  （可选）检查并确认配置信息，然后单击**创建**。
        -   您可以在**资源栈信息**页签查看创建状态，当**状态**为**创建成功**时，说明您组合购买的ECS实例和EIP实例已成功。
        -   您可以在**事件**页签查看资源栈中每个资源的创建情况。
5.  单击**确定**，即可在控制台查看购买成功的EIP实例，**绑定实例类型/ID**列的信息即为组合购买的ECS实例。


## 组合购ECS（新建VPC）

1.  登录[弹性公网IP管理控制台](https://vpc.console.aliyun.com/eip)。

2.  在顶部菜单栏处，选择EIP的地域。

3.  在**弹性公网IP**页面，选择**组合购买** \> **组合购ECS（新建VPC）**。

4.  在**组合购ECS（新建VPC）**对话框，完成以下操作。

    1.  配置以下信息，然后单击**下一步**。

        配置完成模板参数信息后，您可以单击**创建**，跳过配置资源栈信息和检查并确认配置信息步骤，直接组合创建ECS实例和EIP实例。

        **说明：** 您也可以单击**上一步**，然后单击**选择已有模板**，根据控制台提示，组合创建ECS实例和EIP实例。

        |配置|说明|
        |--|--|
        |**资源栈名称**|名称可以包含数字、大小写字母、短划线（-）、下划线（\_）。必须以字母开头，且长度必须小于255个字符。|
        |**VPC**|
        |**专有网络IPv4网段**|新建VPC的IPv4网段。|
        |**交换机子网网段**|新建VPC下的交换机网段，交换机的网段必须在VPC的网段内。|
        |**EIP**|
        |**弹性公网带宽**|EIP实例的带宽，取值范围：**1**~**200**， 单位：Mbps。|
        |**弹性公网地址的收费类型**|        -   **PayByBandwidth**：按带宽付费。
        -   **PayByTraffic**：按流量付费。 |
        |**ECS**|
        |**数量**|需要创建的ECS实例和EIP实例的数量，1组ECS实例和EIP实例算1个，取值范围：**1**~**140**。|
        |**交换机可用区**|选择交换机的可用区。|
        |**镜像**|选择ECS实例的镜像。|
        |**实例规格**|选择ECS实例的规格。|
        |**系统盘类型**|选择ECS实例的系统盘类型。|
        |**系统盘空间**|填写系统盘的空间大小，取值范围：**40**~**500**， 单位：GB。|
        |**实例的付费方式**|选择ECS实例的付费方式。        -   **PostPaid**：按量付费。
        -   **PrePaid**：包年包月。 |
        |**安全组名称**|安全组实例的名称，由2~128个大小写字母、汉字、数字、半角句号（.）、下划线（\_）和短划线（-）组成。|
        |**实例密码**|设置ECS实例的登录密码，如果ECS实例选择用实例密码登录，则**密钥对名称**可不填。如果ECS实例选择用密钥对登录，则**实例密码**可不填。|
        |**密钥对名称**|输入已有密钥对的名称。如使用**实例密码**登录，**密钥对名称**不需要填写。|

    2.  （可选）配置资源栈信息，然后单击**下一步**。

        |配置|说明|
        |--|--|
        |**资源栈策略**|选择资源栈策略。        -   **无资源栈策略**：不设置资源栈策略。
        -   **输入资源栈策略**：上传文件或在文本框手动输入资源栈策略。
关于资源栈策略详情，请参见[资源栈策略](/intl.zh-CN/资源栈/资源栈策略.md)。|
        |**失败时回滚**|        -   **已启用**：创建资源栈失败时，启用回滚策略。
        -   **已禁用**：创建资源栈失败时，禁用回滚策略。 |
        |**超时设置**|如果所有资源的创建或更新没有在这个时间内完成，系统将自动回滚到创建或更新之前的状态。取值范围：**10**~**1440**，单位：分钟。|
        |**删除保护**|防止资源栈被意外删除。        -   **已启用**：启用删除保护。
        -   **已禁用**：禁用删除保护。 |
        |**RAM角色**|您可以创建可信实体为资源编排服务的RAM角色，然后根据ROS模板中资源所需最小权限为RAM角色授权。        -   如果指定RAM角色，ROS将根据RAM角色的权限创建资源栈。关于如何创建RAM角色和为RAM角色授权，请参见[创建可信实体为阿里云服务的RAM角色](/intl.zh-CN/角色管理/创建RAM角色/创建可信实体为阿里云服务的RAM角色.md)和[为RAM角色授权](/intl.zh-CN/角色管理/为RAM角色授权.md)。
        -   如果不指定RAM角色，ROS将使用当前账号相关权限创建资源栈。 |
        |**标签**|添加标签。标签由一对键值对组成，方便您对资源栈进行分类。|

    3.  （可选）检查并确认配置信息，然后单击**创建**。
        -   您可以在**资源栈信息**页签查看创建状态，当**状态**为**创建成功**时，说明您组合购买的ECS实例和EIP实例已成功。
        -   您可以在**事件**页签查看资源栈中每个资源的创建情况。
5.  单击**确定**，即可在控制台查看购买成功的EIP实例，**绑定实例类型/ID**列的信息即为组合购买的ECS实例。


## 组合购买NAT网关和EIP

您已经创建了VPC和交换机。具体操作，请参见[使用专有网络](/intl.zh-CN/专有网络和交换机/使用专有网络.md)。

1.  登录[弹性公网IP管理控制台](https://vpc.console.aliyun.com/eip)。

2.  在**弹性公网IP**页面，选择**组合购买** \> **组合购NAT**。

3.  在**组合购买（NAT网关+弹性公网IP）**页面，配置以下信息，然后单击**立即购买**完成支付。

    -   **基础信息**：选择需要创建NAT网关和EIP的地域。
    -   **NAT网关（按量付费）**：

        |配置|说明|
        |--|--|
        |**网关类型**|默认选择**增强型**：增强型NAT网关的功能优势，请参见[增强型NAT网关](/intl.zh-CN/增强型NAT网关/增强型NAT网关（新推出）.md)。 |
        |**VPC ID**|选择需要创建NAT网关的VPC。创建NAT网关后，不能修改VPC。**说明：** 如果在VPC列表中，找不到目标VPC，请排查是否有以下情况：

        -   在选择地域内没有VPC。
        -   查看该VPC中是否存在目标网段为0.0.0.0/0的自定义路由。如果存在，请删除该路由条目。
        -   RAM账号不具备读取访问VPC的权限，请联系主账号进行授权。 |
        |**交换机ID**|选择NAT网关实例所属的交换机。|
        |**EIP**|选择要绑定到NAT网关的EIP：        -   **选择已有**：从已有EIP中选择要绑定到NAT网关的EIP，支持选择您创建的包年包月或按量付费的EIP实例。
        -   **新购EIP**：新购EIP然后绑定到NAT网关，新购EIP只支持按量付费的EIP实例。 |
        |**选择EIP**|当**EIP**设置为**选择已有**时需配置该项，从EIP列表中选择绑定到NAT网关的EIP。|
        |**计费周期**|显示NAT网关的计费周期，默认显示**按小时**。|
        |**计费类型**|显示NAT网关的计费类型：**按使用量计费**，按NAT网关实际使用量收费。更多信息，请参见[按使用量计费](/intl.zh-CN/购买指南/按量付费.md)。|

    -   **弹性公网IP开通**：

        **说明：**

        -   仅当**EIP**选择为**新购EIP**时需配置此模块内容。
        -   如果确认新购EIP，请勾选**弹性公网IP开通**，否则不能创建EIP。
        |配置|说明|
        |--|--|
        |**线路类型**|显示EIP的线路类型，默认显示**BGP（多线）**。|
        |**网络类型**|显示EIP的网络类型。|
        |**带宽峰值**|根据业务需要，选择EIP的带宽峰值。|
        |**带宽计费方式**|选择EIP的带宽计费方式：         -   **按固定带宽计费**：由带宽值决定每日账单价格，与实际使用流量无关。更多信息，请参见[t12818.md\#section\_t0q\_l86\_bun](/intl.zh-CN/产品计费/按量计费.md)。
        -   **按使用流量计费**：根据每小时出公网的实际流量计费。更多信息，请参见[按使用流量计费](/intl.zh-CN/产品计费/按量计费.md)。 |
        |**名称**|输入EIP的名称。名称长度为2~128个字符，以大小写字母或中文开头，可包含数字、半角句号（.）、下划线（\_）和短划线（-）。 |
        |**计费周期**|显示EIP的计费周期。目前，按固定带宽计费的EIP仅支持**按天**计费，按使用流量计费的EIP仅支持**按小时**计费。 |
        |**购买数量**|根据业务需要，选择购买EIP的数量。|

4.  在**确认订单**页面确认支付金额，然后单击**确认购买**。

5.  在支付订单页面单击**支付**。

    当出现**恭喜，开通成功！**的提示后，说明您购买成功。


## 组合购买CLB（原SLB）和EIP

您已经创建了VPC和交换机。具体操作，请参见[使用专有网络](/intl.zh-CN/专有网络和交换机/使用专有网络.md)。

1.  登录[弹性公网IP管理控制台](https://vpc.console.aliyun.com/eip)。

2.  在**弹性公网IP**页面，选择**组合购买** \> **组合购CLB**。

3.  在**组合购买（CLB+EIP）**页面，配置以下信息，然后单击**立即购买**完成支付。

    -   **基础信息**：选择需要创建CLB和EIP的地域。
    -   **传统型负载均衡CLB（按量付费）**：

        您需要选中**传统型负载均衡CLB（按量付费）**复选框，才能成功购买CLB实例。

        |配置|说明|
        |:-|:-|
        |**可用区类型**|默认选择**多可用区**，即CLB实例会部署在两个可用区上。默认启用主可用区的实例。当主可用区出现故障时，将会自动切换到备可用区继续提供负载均衡服务，可以大大提升本地可用性。|
        |**主可用区**|选择CLB实例的主可用区，主可用区是当前承载流量的可用区。|
        |**备可用区**|选择CLB实例的备可用区。备可用区默认不承载流量，主可用区不可用时才承载流量。|
        |**实例名称**|自定义新建CLB实例的名称。 长度限制为1~80个字符，允许包含中文、字母、数字、短划线（-）、正斜线（/）、半角句号（.）和下划线（\_）等字符。 |
        |**实例规格**|选择CLB的性能规格。

不同的性能规格所提供的性能指标也不同，更多信息，请参见[CLB实例概述](/intl.zh-CN/传统型负载均衡CLB/CLB用户指南/实例/实例概述.md)。 |
        |**实例类型**|默认选择**私网**，即对内私有的负载均衡服务，系统会分配私网服务地址，只能通过阿里云内部网络访问该负载均衡服务，无法从Internet访问。更多信息，请参见[CLB实例概述](/intl.zh-CN/传统型负载均衡CLB/CLB用户指南/实例/实例概述.md)。|
        |**功能特性**|选择CLB实例的功能特性。        -   **标准功能**
        -   **支持PrivateLink** |
        |**专有网络**|选择私网CLB实例所属的VPC。|
        |**网络类型**|默认选择**专有网络**|
        |**计费方式**|默认选择**按使用流量计费**。|

    -   **弹性公网IP开通**：

        您需要选中**弹性公网IP开通**复选框，才能成功购买EIP实例。

        |配置|说明|
        |--|--|
        |**线路类型**|显示EIP的线路类型，默认显示**BGP（多线）**。|
        |**网络类型**|显示EIP的网络类型，默认显示**公共云**。|
        |**带宽峰值**|根据业务需要，选择EIP的带宽峰值。|
        |**带宽计费方式**|选择EIP的带宽计费方式：         -   **按固定带宽计费**：由带宽值决定每日账单价格，与实际使用流量无关。更多信息，请参见[t12818.md\#section\_t0q\_l86\_bun](/intl.zh-CN/产品计费/按量计费.md)。
        -   **按使用流量计费**：根据每小时出公网的实际流量计费。更多信息，请参见[按使用流量计费](/intl.zh-CN/产品计费/按量计费.md)。 |
        |**名称**|输入EIP的名称。名称长度为2~128个字符，以大小写字母或中文开头，可包含数字、半角句号（.）、下划线（\_）和短划线（-）。 |
        |**计费周期**|显示EIP的计费周期。目前，按固定带宽计费的EIP仅支持**按天**计费，按使用流量计费的EIP仅支持**按小时**计费。 |

4.  在**确认订单**页面确认支付金额，然后单击**确认购买**。

5.  在支付订单页面单击**支付**。

    当出现**恭喜，开通成功！**的提示后，说明您购买成功。


